注意到由于我们可以询问结果结点是否在一个集合内，所以使用二分可以做到在 $9$ 次内求出一个结点 $u$ 走 $k$ 步到达的结点。

又注意到只需要求出 $1$ 所在基环树的环上所有结点，就可以对每个结点询问一次来判断是否在 $1$ 所在的连通块内。

先求出 $125$ 个环上的点（如果不足 $125$ 个，就可以直接按照上面的做法结束）。

再枚举每个点，尝试走 $125$ 步判断是否能到已知点，这样环上至少 $250$ 个点都已知了。

再次枚举未知的点，若走足够多（设为 $t$）步走不到已知点上，再尝试走 $t+250$ 步，如果它在环上，则一定能走到已知点。于是这个问题就做完了。

总共用了 $125\times 9+(500-125)+(500-250)\times 2=2000$ 次询问。
