打表后容易发现经常会出现很长一段相等的段。用一个数组存下已知的段和值，用优先队列存下可能会对函数值造成修改的位置，每次取出最小的位置处理即可。

经过程序计算可知段数非常小，大约在 $10^5$ 级别，可以通过。
