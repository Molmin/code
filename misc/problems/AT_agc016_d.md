容易发现可以在序列最后加一项表示所有数的异或和，那么一次操作就相当于把序列中的一项与最后一项交换。

考虑对于位置 $i$，若 $a_i\not=b_i$，就把 $a_i$ 和 $b_i$ 的连边，此时会形成若干联通块。

对于每个联通块，都要依次进行交换操作。略微模拟发现，若联通块包括最后一项，则需要的次数即为联通块中边的数量。否则需要次数要变多 $1$（因为先把最后一个数换到联通块内部）。

因为值域较大，所以需要离散化。

时间复杂度 $\Theta(n\log n)$。
