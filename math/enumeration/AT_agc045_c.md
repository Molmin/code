首先容易发现操作可以加强为对 $\geq a$ 或 $\geq b$ 的段进行修改。由于可以直接把整个串改为 `1`，所以 $a,b$ 可以交换，不妨设 $a\leq b$。

把操作反过来，考虑对于一个 `01` 序列，能否经过若干次逆操作变为全为 `0`。

原操作的逆操作就是选择一个长度 $\geq a$ 的全为 `0` 的段变为任意数。因为我们现在不知道变为什么数对我们有利，我们不妨把它们变为 `?`，这样我们可以选择一个长度 $\geq a$ 的不包含 `1` 的段全变为 `?`，或选择一个长度 $\geq b$ 的不包含 `0` 的段全变为 `?`。而目标就是把整个序列变为 `0` 或 `?`，等价于变为全部是 `?`。

由于 `?` 的功能严格包含 `0` 和 `1` 的功能，所以我们贪心地只要遇到长 $\geq a$ 的非 `1` 段就变为 `?`。

注意到如果我们把一个长为 $b$ 的段变为了 `?`，由于 $a\leq b$，我们可以把这个 `?` 段无限延长，直至整个序列都变为 `?`。

于是我们得出了如下结论：一个序列能否变为全 `0` 串，等价于把其中所有长度至少为 $a$ 的极长连续 `1` 段全变为 `0` 后是否存在长至少为 $b$ 的连续 `0` 段。

由容斥原理，只需求用长 $< a$ 的极长连续 `1` 段分割后每段长 $< b$ 且所有极长连续 `1` 段的长度都 $\geq a$。

考虑动态规划，记

- $f_i$ 表示到第 $i$ 位为止最后一个连续段是长度小于 $a$ 的 `1` 段；
- $g_{i,j}$ 表示到第 $i$ 位为止有一个长度为 $j$ 不包含长度小于 $a$ 的极长连续 `1` 段的极长段且最后一个连续段是 `0`；
- $h_{i,j}$ 表示到第 $i$ 位为止有一个长度为 $j$ 不包含长度小于 $a$ 的极长连续 `1` 段的极长段且最后一个连续段是 `1`。

用朴素方法转移是 $\Theta(n^3)$ 的，使用前缀和优化即可做到 $\Theta(n^2)$。
