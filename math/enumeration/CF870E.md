容易想到将横纵坐标离散化建出二分图，每个点视为一条边。问题变为对于每条边可以把至多一个端点染色。

考虑对于每个大小为 $x$ 的连通块计数：

- 如果连通块是一棵树，则显然只有所有点都被染色的情况不可能出现，总方案数为 $2^x-1$。
- 如果连通块不是树，这意味着它一定有一个环，这样任意的染色方案都可以出现，方案数为 $2^x$。

时间复杂度 $\Theta(n)$ 或者 $O(n\log n)$。
