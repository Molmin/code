注意到可以给每个项链加上一个正数，相当于可以给其中一个项链加上或减去一个数。设将第一个项链加上 $c$。

则对于第 $i$ 个位置对答案的贡献为 $(x_i+c-y_i)^2=x_i^2+y_i^2+c^2+2(x_i-y_i)c-2x_iy_i$。全部累加起来，前两项是固定的，后面的部分等于 $nc^2+2c\sum(x_i-y_i)-2\sum x_iy_i$。前两项分别是 $c$ 的二次项和一次项，且系数固定，可以用一元二次方程求出最小值（注意 $c$ 必须是整数，求出取最小值的位置后要四舍五入）。

最后一部分则需要使 $\sum x_iy_i$ 最大。考虑让 $y$ 倒过来，$x$ 复制一遍，则移位 $\Delta$ 个位置时答案为 $\sum x_{i+\Delta}y_{n-i+1}$，可以用卷积求解（每一项答案不超过 $5\times 10^4\times 100^2 = 5\times 10^8$，可以使用 $998244353$ 作 NTT 模数）。

时间复杂度 $\Theta(n\log n)$。
