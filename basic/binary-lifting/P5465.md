设 $s(i,j)$ 表示从 $j \sim i$ 中任意一个点出发到 $i$ 需要的最小步数和。

从 $x$ 出发，一步可以到达 $[l_x,x-1]$ 中的所有点。两步可以到达的最小的点是 $\min\limits_{i=l_x}^nl_i$，这是因为如果存在 $j > i$ 使得 $l_j\leq i$，则一定可以先从 $i$ 走到 $j$ 再从 $j$ 走到 $[l_j,i]$ 内的点。

所以，如果用 $t$ 步能到达 $[y,n]$ 内的所有点，则可以用 $t+1$ 步到达 $\left[\min\limits_{i=y}^nl_i,n\right]$ 内的所有点。

考虑倍增，一次跳 $2^k$ 步，并用一个数组记录跳的步数在 $2^k$ 步以内的点的步数之和，每次查询从 $i$ 跳到 $1$ 即可。

时间复杂度 $O((n+q)\log n)$。
