考虑到加上边权为 $0$ 的边没有意义，所以问题转化为从树中找出 $K$ 条不相交的链。

考虑树形动态规划。记 $dp_{u,i,j}$（$0\leq j\leq 2$）表示在以 $u$ 为根的子树中，找出 $i$ 条互不相交的链，且与 $u$ 相连的链上的边的数量为 $j$（即 $u$ 不在链上、在链的一端或者在链的中间）时的最大边权和。转移略。

时间复杂度 $\Theta(nk^2)$。

考虑 WQS 二分，把链的数量加入权值中去，二分链的权值，就可以忽略状态中链的数量这一维，若链太少或太多再进行调整。

时间复杂度 $\Theta(n\log n\log v)$。
