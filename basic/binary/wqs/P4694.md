注意到我们不能很好地直接固定光盘的数量，所以考虑 WQS 二分，给每个光盘增加一个负的贡献 $t$。

而如何计算最大的贡献？考虑从前到后扫描一遍做反悔贪心。每次先把 $a_i$ 加入堆中，并取出堆顶，若与 $b_i$ 组成的光盘对结果的贡献是整数，就立刻添加该光盘，并把 $t-b_i$ 加入堆中，这样后面可以让 $a_i$ 更换匹配的 $b_i$ 来产生更加优秀的解。

时间复杂度 $\Theta(n\log n\log v)$。
