显然取两个数求 $\gcd$，剩下的数求按位与是最优的。下文中记 $v = \max a_i$。

对于每个二进制位，如果存在至少三个数在这位上是 $0$，那么最终这位一定是 $0$，故只需考虑这一位上只有至多两个数为 $1$ 的情形。如果我们选的两个数包含至少一个这样的数，那么可以直接枚举。这样的数有 $O(\log v)$ 个，直接枚举选择的另一个数，用 ST 表 $\Theta(1)$ 查询区间与和，由于要计算 $\gcd$，所以这部分时间复杂度为 $O(n \log^2 v)$。

如果我们选择的数不包含这样的数，那么与和已经固定，这时从大到小枚举 $\gcd$ 的值并判断即可，只需要枚举 $O(v)$ 组数。

时间复杂度 $O(n \log^2 v + v \log v)$。
