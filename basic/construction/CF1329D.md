注意到一次操作最多可以让相邻相同字符的数量减 $2$，于是我们可以构造一个新的字符串，其中对于 $1 \leq i < n$，如果 $s_i = s_{i+1}$ 就把这个字符加入新的字符串中。每次操作可以把新字符串中相邻两项不同字符删除或者删除一个单独字符。把新字符串删空后还需要额外操作一步把原串整个删掉。

如果新字符串中存在一种字符出现次数超过一半，则让其他的字符与这个字符配对删除，剩下多余的字符一个一个删除是最优的。如果不存在，那么从前往后扫，如果遇到可以删除的，并且删除之后不会使得某个字符出现次数超过一半，就把它删除即可。

注意需要构造方案，使用线段树维护哪些位置没被删除即可。
